function office_hours_field_formatter_view(a,b,c,d,e,f,g){try{var h=[];if(!empty(f)){var i=[];switch(g.settings.daysformat){case"number":for(var j=1;j<=7;j++)i.push(j);break;case"none":for(var j=0;j<7;j++)i.push("");break;case"long":i=[t("Sunday"),t("Monday"),t("Tuesday"),t("Wednesday"),t("Thursday"),t("Friday"),t("Saturday")];break;case"short":default:i=[t("Sun"),t("Mon"),t("Tue"),t("Wed"),t("Thu"),t("Fri"),t("Sat")]}for(var k=[],l=0;l<7;l++)k.push({startday:l,endday:null,times:[],current:!1,next:!1});var m=null,n=parseInt(date("w")),o=date("Gi"),p=!1,q=null;for(var r in f)if(f.hasOwnProperty(r)){var s=f[r],l=parseInt(s.day),u=_office_hours_time_to_mil(s.starthours),v=_office_hours_time_to_mil(s.endhours),w=s.comment,x={start:u,end:v,comment:w};k[l].times.push(x),l<n&&(q||(q=l)),l-n==-1||l-n==6?u>=v&&v>=o&&(p=!0,k[l].current=!0,q=l):l==n?u<=o?(u>v||u==v||u<v&&v>o)&&(p=!0,k[l].current=!0,q=l):q=l:l>n&&(!q||q<n)&&(q=l)}if(q&&(k[q].next=!0),g.settings.date_first_day>0)for(var j=1;j<=g.settings.date_first_day;j++){var y=k.shift();k.push(y)}if(g.settings.compress)for(var l=0;l<k.length;l++)if(k[l].times.length>0){for(var z=k[l].times[0],A=0;A<k[l].times.length;A++)k[l].times[A].start<z.start&&(z.start=k[l].times[A].start),k[l].times[A].end>z.end&&(z.end=k[l].times[A].end);k[l].times=[z]}if(g.settings.grouped)for(var l=0;l<7;l++){var x;if(0==l)x=k[l].times;else if(JSON.stringify(x)!=JSON.stringify(k[l].times))x=k[l].times;else{var B=l-1;B<0&&(B=6),k[l].endday=k[l].startday,k[l].startday=k[B].startday,k[l].current=k[l].current||k[B].current,k[l].next=k[l].next||k[B].next,delete k[B]}}var C={element:f,display:g,days:k,daynames:i,open:p,timezone:m};h.push({markup:theme("office_hours_field_formatter_default",C)})}return h}catch(D){console.log("office_hours_field_formatter_view - "+D)}}function office_hours_field_widget_form(a,b,c,d,e,f,g,h){try{switch(f[g].type="hidden","office_hours"==d.widget.type&&_office_hours_correct_items_delta(f,c.settings.date_first_day,c.settings.cardinality),_office_hours_field_set_values(c,d,f,g),d.widget.type){case"office_hours_dynamic_widget":var i=!1;empty(f[g].value)||(i=!0);var j=_office_hours_extract_value_parts(f[g].value),k=parseInt(c.settings.granularity),l=!1;1!=c.settings.hoursformat&&3!=c.settings.hoursformat||(l=!0);var m,n,o,p,q,r,s;f[g].children.push({markup:'<div class="office-hours-day-container" style="'+(i?"":"display:none;")+'">'}),m={id:f[g].id+"-day",onchange:"office_hours_update_field_value(this, '"+f[g].id+"');"},q=_office_hours_widget_days(j.day,m),q.prefix=theme("office_hours_label",{title:t("Day")}),f[g].children.push(q),n={id:f[g].id+"-starthours",onchange:"office_hours_update_field_value(this, '"+f[g].id+"');"},r=_office_hours_widget_starthours(j.starthours,n,k,l),f[g].children.push({markup:theme("office_hours_label",{title:t("From:")})}),f[g].children.push(_office_hours_widget_starthours_container(l,!0));for(var u=0;u<r.length;u++)f[g].children.push(r[u]);f[g].children.push(_office_hours_widget_starthours_container(l,!1)),o={id:f[g].id+"-endhours",onchange:"office_hours_update_field_value(this, '"+f[g].id+"');"},s=_office_hours_widget_endhours(j.endhours,o,k,l),f[g].children.push({markup:theme("office_hours_label",{title:t("To:")})}),f[g].children.push(_office_hours_widget_endhours_container(l,!0));for(var u=0;u<s.length;u++)f[g].children.push(s[u]);if(f[g].children.push(_office_hours_widget_endhours_container(l,!1)),p={"data-icon":"delete","data-iconpos":"right",href:"#",onclick:"office_hours_remove_day(this);"},f[g].children.push({type:"button",attributes:p,text:t("Remove")}),f[g].children.push({markup:"</div>"}),g==c.cardinality-1){for(var v="display:none;",u=0;u<c.cardinality;u++)if(empty(f[u].value)){v="";break}attributes_add_day={"data-icon":"calendar","data-iconpos":"right",class:"office-hours-add-day",href:"#",onclick:"office_hours_add_day(this);",style:v},f[g].children.push({type:"button",attributes:attributes_add_day,text:t("Add an hour")})}break;case"office_hours":var w,x,y=[t("Sunday"),t("Monday"),t("Tuesday"),t("Wednesday"),t("Thursday"),t("Friday"),t("Saturday")];w=parseInt(c.settings.date_first_day)+Math.floor(g/c.settings.cardinality),x=g-(w-c.settings.date_first_day)*c.settings.cardinality,w>=7&&(w-=7);var i=!1;empty(f[g].value)||(i=!0);var j=_office_hours_extract_value_parts(f[g].value),k=parseInt(c.settings.granularity),l=!1;1!=c.settings.hoursformat&&3!=c.settings.hoursformat||(l=!0);var n,o,p,r,s,z;0==x&&(f[g].children.push({markup:theme("header",{text:y[w]})}),f[g].children.push({markup:'<div class="office-hours-day-container">'})),f[g].children.push({markup:'<div class="office-hours-day-delta-container" style="'+(i?"":"display:none;")+'">'}),n={id:f[g].id+"-starthours",onchange:"office_hours_update_field_value(this, '"+f[g].id+"');"},r=_office_hours_widget_starthours(j.starthours,n,k,l),f[g].children.push({markup:theme("office_hours_label",{title:t("From:")})}),f[g].children.push(_office_hours_widget_starthours_container(l,!0));for(var u=0;u<r.length;u++)f[g].children.push(r[u]);f[g].children.push(_office_hours_widget_starthours_container(l,!1)),o={id:f[g].id+"-endhours",onchange:"office_hours_update_field_value(this, '"+f[g].id+"');"},s=_office_hours_widget_endhours(j.endhours,o,k,l),f[g].children.push({markup:theme("office_hours_label",{title:t("To:")})}),f[g].children.push(_office_hours_widget_endhours_container(l,!0));for(var u=0;u<s.length;u++)f[g].children.push(s[u]);if(f[g].children.push(_office_hours_widget_endhours_container(l,!1)),empty(c.settings.comment)||(attributes_comment={id:f[g].id+"-comment",onblur:"office_hours_update_field_value(this, '"+f[g].id+"');"},z=_office_hours_widget_comments(j.comment,attributes_comment),z.prefix=theme("office_hours_label",{title:t("Comment")}),f[g].children.push(z)),attributes_remove_day_delta={"data-icon":"delete","data-iconpos":"right",href:"#",onclick:"office_hours_remove_day_delta(this);"},f[g].children.push({type:"button",attributes:attributes_remove_day_delta,text:t("Remove")}),f[g].children.push({markup:"</div>"}),x==c.settings.cardinality-1){for(var v="display:none;",u=0;u<c.settings.cardinality;u++){var A=g-x+u;if(empty(f[A].value)){v="";break}}attributes_add_day_delta={"data-icon":"calendar","data-iconpos":"right",class:"office-hours-add-day-delta",href:"#",onclick:"office_hours_add_day_delta(this);",style:v},f[g].children.push({type:"button",attributes:attributes_add_day_delta,text:t("Add an hour")}),f[g].children.push({markup:"</div>"})}break;default:console.log("office_hours_field_widget_form - unknown widget type: "+d.widget.type)}}catch(B){console.log("office_hours_field_widget_form - "+B)}}function _office_hours_widget_days(a,b){try{var c={" ":t("- Select -")," 0":t("Sunday")," 1":t("Monday")," 2":t("Tuesday")," 3":t("Wednesday")," 4":t("Thursday")," 5":t("Friday")," 6":t("Saturday")};return field={type:"office_hours_select",value:" "+a,attributes:b,options:c},field}catch(d){console.log("_office_hours_widget_days",d)}}function _office_hours_widget_starthours_container(a,b){try{return _office_hours_widget_hours_container(a,b)}catch(c){console.log("_office_hours_widget_starthours_container",c)}}function _office_hours_widget_starthours(a,b,c,d){try{return _office_hours_widget_hours(a,b,c,d)}catch(e){console.log("_office_hours_widget_starthours",e)}}function _office_hours_widget_endhours(a,b,c,d){try{return _office_hours_widget_hours(a,b,c,d)}catch(e){console.log("_office_hours_widget_endhours",e)}}function _office_hours_widget_endhours_container(a,b){try{return _office_hours_widget_hours_container(a,b)}catch(c){console.log("_office_hours_widget_endhours_container",c)}}function _office_hours_widget_hours(a,b,c,d){try{var e,f,g=[];d?(e=1,f=12):(e=0,f=23);for(var h={" ":t("- Select -")},i=e;i<=f;i++){var j=i;i<10&&(j="0"+i),j=" "+j,h[j]=i}var k={id:b.id+"-hour",onchange:b.onchange},l={type:"office_hours_select",value:" "+a[0],attributes:k,options:h,prefix:'<div class="ui-block-a">',suffix:"</div>"};g.push(l);for(var m={" ":t("- Select -")},i=0;i<60;i+=c){var n=i,o=i;i<10&&(n="0"+i,o="0"+i),n=" "+n,m[n]=o}var p={id:b.id+"-minute",onchange:b.onchange},q={type:"office_hours_select",value:" "+a[1],attributes:p,options:m,prefix:'<div class="ui-block-b">',suffix:"</div>"};if(g.push(q),d){var r={"":t("- Select -"),am:t("AM"),pm:t("PM")},s={id:b.id+"-ampm",onchange:b.onchange},u={type:"office_hours_select",value:a[2],attributes:s,options:r,prefix:'<div class="ui-block-c">',suffix:"</div>"};g.push(u)}return g}catch(v){console.log("_office_hours_widget_hours",v)}}function _office_hours_widget_hours_container(a,b){try{return b?{markup:'<div class="'+(a?"ui-grid-b":"ui-grid-a")+'">'}:{markup:"</div>"}}catch(c){console.log("_office_hours_widget_endhours_container",c)}}function _office_hours_widget_comments(a,b){try{return b.value=a,field={type:"office_hours_textfield",attributes:b},field}catch(c){console.log("_office_hours_widget_comments",c)}}function _office_hours_correct_items_delta(a,b,c){var d={};for(var e in a)if(a.hasOwnProperty(e)&&void 0!==a[e].item){var f=a[e].item;void 0!==f.day&&(void 0===d[f.day]&&(d[f.day]=[]),d[f.day].push(f)),delete f,delete a[e].item}for(var g=0;g<7;g++){var h=g+parseInt(b);if(h>=7&&(h-=7),void 0!==d[h])for(var i=0;i<c;i++)if(void 0!==d[h][i]){var e=g*c+i;a[e].item=d[h][i]}}}function _office_hours_field_set_values(a,b,c,d){try{var e=null;if(void 0!==c[d].item?e=c[d].item:void 0===c[d].value||""==c[d].value?(""!=c[d].default_value&&c[d].default_value||""==b.settings.default_value||(c[d].default_value=b.settings.default_value),void 0!==c[d].default_value&&c[d].default_value&&("office_hours_dynamic_widget"==b.widget.type?0==d&&(e=c[d].default_value):"office_hours"==b.widget.type&&$.each(c[d].default_value,function(b,c){var f;if(f=(c.day-a.settings.date_first_day)*a.settings.cardinality+c.daydelta,a.settings.date_first_day>c.day&&(f+=7*a.settings.cardinality),f==d)return e=c,!1}))):"office_hours_dynamic_widget"==b.widget.type?0==d&&(e=c[d].value):"office_hours"==b.widget.type&&$.each(c[d].value,function(b,c){var f;if(f=(c.day-a.settings.date_first_day)*a.settings.cardinality+c.daydelta,a.settings.date_first_day>c.day&&(f+=7*a.settings.cardinality),f==d)return e=c,!1}),c[d].value="",!empty(e)){var f,g,h,i;if(f="",g=["","",""],h=["","",""],i="",void 0===e.day||empty(e.day)||(f=e.day),void 0!==e.starthours&&!empty(e.starthours)){var j=""+e.starthours;j="0000".substr(0,4-j.length)+j,g=[j.substr(0,2),j.substr(-2),""],1!=a.settings.hoursformat&&3!=a.settings.hoursformat||(g[0]>=12?(g[0]>12&&(g[0]-=12,g[0]<10&&(g[0]="0"+g[0])),g[2]="pm"):g[2]="am")}if(void 0!==e.endhours&&!empty(e.endhours)){var k=""+e.endhours;k="0000".substr(0,4-k.length)+k,h=[k.substr(0,2),k.substr(-2),""],1!=a.settings.hoursformat&&3!=a.settings.hoursformat||(h[0]>=12?(h[0]>12&&(h[0]-=12,h[0]<10&&(h[0]="0"+h[0])),h[2]="pm"):h[2]="am")}void 0!==e.comment&&e.comment&&(i=e.comment),c[d].value=_office_hours_format_value(f,g,h,i)}}catch(l){console.log("_office_hours_field_set_values",l)}}function _office_hours_format_value(a,b,c,d){try{return a+"|"+b.join(":")+"|"+c.join(":")+"|"+d}catch(e){console.log("_office_hours_format_value",e)}}function _office_hours_extract_value_parts(a){try{var b;return b={day:"",starthours:["","",""],endhours:["","",""],comment:""},value_array=a.split("|",4),void 0!==value_array[0]&&(b.day=value_array[0]),void 0!==value_array[1]&&(starthours_array=value_array[1].split(":",3),void 0!==starthours_array[0]&&(b.starthours[0]=starthours_array[0]),void 0!==starthours_array[1]&&(b.starthours[1]=starthours_array[1]),void 0!==starthours_array[2]&&(b.starthours[2]=starthours_array[2])),void 0!==value_array[2]&&(endhours_array=value_array[2].split(":",3),void 0!==endhours_array[0]&&(b.endhours[0]=endhours_array[0]),void 0!==endhours_array[1]&&(b.endhours[1]=endhours_array[1]),void 0!==endhours_array[2]&&(b.endhours[2]=endhours_array[2])),void 0!==value_array[3]&&(b.comment=value_array[3]),b}catch(c){console.log("_office_hours_extract_value_parts",c)}}function office_hours_update_field_value(a,b){try{var c,d,e,f;c=$("#"+b).val(),d=$.trim($(a).val()),e=_office_hours_extract_value_parts(c),f=$(a).attr("id"),f.endsWith("-day")?e.day=d:f.endsWith("-starthours-hour")?e.starthours[0]=d:f.endsWith("-starthours-minute")?e.starthours[1]=d:f.endsWith("-starthours-ampm")?e.starthours[2]=d:f.endsWith("-endhours-hour")?e.endhours[0]=d:f.endsWith("-endhours-minute")?e.endhours[1]=d:f.endsWith("-endhours-ampm")?e.endhours[2]=d:f.endsWith("-comment")&&(e.comment=d),$("#"+b).val(_office_hours_format_value(e.day,e.starthours,e.endhours,e.comment))}catch(g){console.log("office_hours_update_field_value",g)}}function office_hours_remove_day(a){try{$(a).parents(".office-hours-day-container").each(function(){$(this).find("select").val(" ").change(),$(this).hide()}).siblings(".office-hours-add-day").show()}catch(b){console.log("office_hours_remove_day",b)}}function office_hours_add_day(a){try{$(a).before($(a).siblings(".office-hours-day-container:hidden").first().show()),0==$(a).siblings(".office-hours-day-container:hidden").length&&$(a).hide()}catch(b){console.log("office_hours_add_day",b)}}function office_hours_remove_day_delta(a){try{$(a).parents(".office-hours-day-delta-container").each(function(){$(this).find("select").val(" ").change(),$(this).hide()}).siblings(".office-hours-add-day-delta").show()}catch(b){console.log("office_hours_remove_day_delta",b)}}function office_hours_add_day_delta(a){try{$(a).before($(a).siblings(".office-hours-day-delta-container:hidden").first().show()),0==$(a).siblings(".office-hours-day-delta-container:hidden").length&&$(a).hide()}catch(b){console.log("office_hours_add_day_delta",b)}}function _office_hours_time_to_mil(a){return empty(a)?a:(a=""+a,a=a.replace(":",""),a="0000".substr(0,4-a.length)+a)}function _office_hours_time_format(a,b){a=""+a,a=a.replace(":",""),a="0000".substr(0,4-a.length)+a;var c=parseInt(a.substr(0,2)),d=parseInt(a.substr(-2)),e=new Date;return e.setHours(c),e.setMinutes(d),date(b,e.getTime())}function office_hours_services_request_pre_postprocess_alter(a,b){try{"system"==a.service&&"connect"==a.resource&&$.each(drupalgap.field_info_fields,function(a,b){if("office_hours"==b.type&&-1==b.cardinality&&void 0!==b.settings.cardinality){var c=7*b.settings.cardinality;drupalgap.field_info_fields[a].cardinality=c}})}catch(c){console.log("office_hours_services_request_pre_postprocess_alter - "+c)}}function office_hours_assemble_form_state_into_field(a,b,c,d,e,f,g,h,i){try{h.use_key=!1,h.use_wrapper=!1,h.use_delta=!0;var j={},k=_office_hours_extract_value_parts(c);if(void 0===k.day||empty(k.day)||(j.day=k.day),void 0!==k.starthours){if(j.starthours={},void 0!==k.starthours[0]&&!empty(k.starthours[0])){var l=parseInt(k.starthours[0]);l>0&&(l+="00"),j.starthours.hours=l}void 0===k.starthours[1]||empty(k.starthours[1])||(j.starthours.minutes=k.starthours[1]),void 0===k.starthours[2]||empty(k.starthours[2])||(j.starthours.ampm=k.starthours[2])}if(void 0!==k.endhours){if(j.endhours={},void 0!==k.endhours[0]&&!empty(k.endhours[0])){var l=parseInt(k.endhours[0]);l>0&&(l+="00"),j.endhours.hours=l}void 0===k.endhours[1]||empty(k.endhours[1])||(j.endhours.minutes=k.endhours[1]),void 0===k.endhours[2]||empty(k.endhours[2])||(j.endhours.ampm=k.endhours[2])}return void 0===k.comment||empty(k.comment)||(j.comment=k.comment),j}catch(m){console.log("office_hours_assemble_form_state_into_field - "+m)}}function theme_office_hours_select(a){try{return theme("select",a)}catch(b){console.log("theme_office_hours_select - "+b)}}function theme_office_hours_textfield(a){try{return theme("textfield",a)}catch(b){console.log("theme_office_hours_textfield - "+b)}}function theme_office_hours_label(a){try{return"<div "+drupalgap_attributes(a.attributes)+"><strong>"+a.title+"</strong></div>"}catch(b){console.log("theme_office_hours_label - "+b)}}function theme_office_hours_field_formatter_default(a){try{var b,c=a.days,d=a.daynames,e=a.open,f=a.display.settings;switch(f.hoursformat){case 2:b="H:i";break;case 0:b="G:i";break;case 1:case 3:b="g:i a"}for(var g=3,h="",i="",j=0;j<c.length;j++)if(void 0!==c[j]){var k=d[c[j].startday];c[j].endday&&(k+=f.separator_grouped_days+d[c[j].endday]),k+=f.separator_day_hours,k.length>g&&(g=k.length);var l,m;if(c[j].times&&0!=c[j].times.length){l=[];for(var n=0;n<c[j].times.length;n++){var o={times:c[j].times[n],format:b,separator:f.separator_hours_hours};l.push(theme("office_hours_time_range",o))}l=l.join(f.separator_more_hours),3==f.hoursformat&&(l=time.replace("am","a.m."),l=time.replace("pm","p.m.")),m=c[j].times[c[j].times.length-1].comment}else l=t(f.closedformat),m="";c[j].output_label=k,c[j].output_times=l,c[j].output_comment=m}for(var j=0;j<c.length;j++)if(void 0!==c[j]){switch(f.showclosed){case"all":break;case"open":if(!c[j].times)continue;break;case"next":if(!c[j].current&&!c[j].next)continue;break;case"none":continue}h+='<span class="oh-display"><span class="oh-display-label" style="width: '+.6*g+'em;">'+c[j].output_label+'</span><span class="oh-display-times oh-display-'+(c[j].times&&0!=c[j].times.length?"hours":"closed")+(c[j].current?" oh-display-current":"")+'">'+c[j].output_times+" "+(c[j].output_comment?c[j].output_comment:"")+f.separator_days+"</span></span>"}switch(h='<span class="oh-wrapper'+(f.grouped?" oh-display-grouped":"")+'">'+h+"</span>",i=e?'<div class="oh-current-open">'+t(f.current_status.open_text)+"</div>":'<div class="oh-current-closed">'+t(f.current_status.closed_text)+"</div>",f.current_status.position){case"before":html=i+h;break;case"after":html=h+i;break;case"hide":default:html=h}return html}catch(p){console.log("theme_office_hours_field_formatter_default - "+p)}}function theme_office_hours_time_range(a){try{void 0===a.times&&(a.times={}),void 0===a.times.start&&(a.times.start=""),void 0===a.times.end&&(a.times.end=""),void 0===a.format&&(a.format="G:i"),void 0===a.separator&&(a.separator=" - ");var b=_office_hours_time_format(a.times.start,a.format),c=_office_hours_time_format(a.times.end,a.format);"0:00"!=c&&"00:00"!=c||(c="24:00");return b+a.separator+c}catch(d){console.log("theme_office_hours_time_range - "+d)}}